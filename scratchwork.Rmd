---
title: "HPR Poll 1"
author: "Angie Shin"
date: "4/24/2021"
output: html_document
---

fraud x trump support

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

key <- read_csv("hpr/Default Report.csv") %>%
  rename(question = `Default Report`) %>% 
  filter(grepl("Q", question)) %>% 
  separate(question, c("code", "question"), 
           sep = " - ") %>% 
  filter(code != "Q16")

data <- read_csv("hpr/HODP x HPR_April 10, 2021_20.31.csv") %>%
  tail(-3) %>% 
  mutate(Q21 = str_split(Q21, ","),
         white = ifelse(grepl("White", Q21), 1, 0),
         asam = ifelse(grepl("Asian or Asian American", Q21), 1, 0),
         mena = ifelse(grepl("Middle Eastern or North African", Q21), 1, 0),
         afram = ifelse(grepl("African or African American", Q21), 1, 0),
         latinx = ifelse(grepl("Latinx", Q21), 1, 0),
         other = ifelse(grepl("Other", Q21), 1, 0),
         pnts = ifelse(grepl("Prefer not to say", Q21), 1, 0)) %>% 
  select(id = ResponseId,
         afram, mena, latinx, asam, white, other, pnts,
         gender = Q20,
         year = Q22,
         # biden = factor(Q1,
         #                levels = c(-2, -1, 0, 1, 2),
         #                labels = c("Strongly Disagree",
         #                            "Disagree",
         #                            "Neutral",
         #                            "Agree",
         #                            "Strongly Agree")), 
         Q1, Q2, Q3, Q4, Q5, Q6, Q7, Q8, Q9, Q10, Q11, Q12)
```

1. I approve of how Joe Biden has handled his job as President.
2. I have concerns regarding the democratic integrity of the 2020 Election.
3. Democrats were right in launching a second impeachment investigation against former President Donald Trump.
4. Big Tech companies should remove figures who spread misinformation on their platforms.
5. Congress was right to remove Representative Marjorie Taylor Greene from her committee seats.
6. Figures who supported, defended, or participated in claims of election fraud or the Jan. 6 Capitol Riots should not have a platform at Harvard.
7. The Republican Party is synonymous with the “Party of Trump.”
8. Figures who support former President Trump should not be given a platform at Harvard.
9. Figures who support the Republican Party should not be given a platform at Harvard.
10. Harvard was wrong not to consider Professor Cornel West for tenure.
11. I feel safe to express my political opinions in social and extracurricular contexts on campus.
12. I feel safe to express my political opinions in academic contexts on campus.
22. Social Class Year:
20. Gender:
21. Race/Ethnicity (Select all that apply):

```{r}
data %>%
  ggplot(aes(x = Q1)) +
  geom_bar() +
  labs(title = key$question[key$code == "Q1"],
       x = "Approval",
       y = "Number of respondents")

poll2 %>%
  ggplot(aes(x = integrity)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = sec_imp)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = false_info)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = mjt)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = fraud_platform)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = party_trump)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = trump_platform)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = rep_platform)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = prof_west)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = op_soc)) +
  geom_bar(aes(y = ..prop..))

poll2 %>%
  ggplot(aes(x = op_acad)) +
  geom_bar(aes(y = ..prop..))

data %>%
  ggplot(aes(x = Q21)) +
  geom_bar()
```

***Reweight based on race***

```{r}
poll2 %>%
  ggplot(aes(x = biden, y = integrity)) +
  geom_jitter(width = 0.1) +
  geom_smooth(method = 'lm')

poll2 %>%
  ggplot(aes(x = biden, y = false_info)) +
  geom_jitter(width = 0.1) +
  geom_smooth(method = 'lm')

poll2 %>%
  ggplot(aes(x = biden, y = op_soc)) +
  geom_jitter(width = 0.1) +
  geom_smooth(method = 'lm')

poll2 %>%
  ggplot(aes(x = biden, y = op_acad)) +
  geom_jitter(width = 0.1) +
  geom_smooth(method = 'lm')

poll2 %>%
  ggplot(aes(x = prof_west, y = race)) +
  geom_jitter(width = 0.1, alpha = 0.3)
```